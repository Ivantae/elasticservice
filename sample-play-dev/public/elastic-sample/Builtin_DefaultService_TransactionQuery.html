<!DOCTYPE html>
<html lang="ko">
<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		
<script src="../html5/jq/jquery-1.9.1.min.js"></script>
<script src="../html5/elastic-util-1.5.js"></script>

<script type="text/javascript">

function loadSrc() {
	var ep = new ElasticParams();
	ep.setParameters({
		service: "sample.elasticservice.service.TextFileReaderService",
		path: "esConfig/sqlrepo/sample/mysql_insert1.xml"
	});
	elastic_ajax(elastic_baseUrl(), ep, function(resEP) {$('#sql1').html(htmlEncode(resEP.getParameter("text")))}, null)

	ep = new ElasticParams();
	ep.setParameters({
		service: "sample.elasticservice.service.TextFileReaderService",
		path: "esConfig/sqlrepo/sample/mysql_update1.xml"
	});
	elastic_ajax(elastic_baseUrl(), ep, function(resEP) {$('#sql2').html(htmlEncode(resEP.getParameter("text")))}, null)
}
		
function requestService(btn) {
	$(document).ajaxStart(function() {
		$(btn).prop('disabled', true);
	}).ajaxStop(function() {
		$(btn).prop('disabled', false);
	});

	var reqEP = new ElasticParams($("#form1"));
	$('#request').html("<xmp>" + reqEP + "</xmp>");
	
	elastic_ajax(
		elastic_baseUrl(), 
		reqEP,
		function(resEP) {
			$('#response').html("<xmp>" + resEP + "</xmp>");
		}, 
		function(resEP) {
			$('#response').html("<xmp>" + resEP + "</xmp>");
			//$('#response').html("ERROR-" + resEP.getCode() + ": " + resEP.getMessage());
		}
	)
}
</script>
</head>
		
<BODY onload="loadSrc()">
	<div data-role="page">
		<div data-role="header">
			<h1>Request two SQLs in a transaction</h1>
			<a href="index.html" data-theme="a" data-ajax="false">Home</a>
		</div>
		
		<div data-role="content">
		<UL>
			<LI>
				<FORM METHOD="GET" ID="form1">
					<B>URL :</B> <script>document.write(elastic_baseUrl())</script><BR> 
					<div data-role="fieldcontain"> 
					?service=<INPUT TYPE=TEXT NAME='service' VALUE="elasticservice.service.QueryService" size=50 READONLY><BR>
					</div>
					<div data-role="fieldcontain"> 
					&service.resType=<SELECT NAME="service.resType">
						<OPTION VALUE="PlatformXml" selected>XML</OPTION>
						<OPTION VALUE="JSON12" selected>JSON12</OPTION>
						</SELECT><BR>
					</div>
					<div data-role="fieldcontain"> 
					&sqlId=<INPUT TYPE=TEXT NAME='sqlId' VALUE="sample.mysql_insert1,sample.mysql_update1"><BR>
					</div>
					<div data-role="fieldcontain"> 
					&action=<INPUT TYPE=TEXT NAME='t' VALUE="true"><BR>
					</div>
					<div data-role="fieldcontain"> 
					&S1COL_title=<INPUT TYPE=TEXT NAME='S1COL_title' VALUE="Senior Programmer" ><BR>
					</div>
					<div data-role="fieldcontain"> 
					&S1COL_city=<INPUT TYPE=TEXT NAME='S1COL_city' VALUE="Illsan" ><BR>
					</div>
					<div data-role="fieldcontain"> 
					&S1COL_phone=<INPUT TYPE=TEXT NAME='S1COL_phone' VALUE="010-1234-5678" ><BR>
					</div>
					<div data-role="fieldcontain"> 
					&S1COL_fax=<INPUT TYPE=TEXT NAME='S1COL_fax' VALUE="02-1234-5678" ><BR>
					</div>
					<div data-role="fieldcontain"> 
					&S1COL_job=<INPUT TYPE=TEXT NAME='S1COL_job' VALUE="Computer Programmer" ><BR>
					</div>
					<div data-role="fieldcontain"> 
					&S1COL_gender=<INPUT TYPE=TEXT NAME='S1COL_gender' VALUE="Male" ><BR>
					</div>
					<div data-role="fieldcontain"> 
					&S2COL_title=<INPUT TYPE=TEXT NAME='S2COL_title' VALUE="Super Man" ><BR>
					</div>
					<div data-role="fieldcontain"> 
					&S2COL_city=<INPUT TYPE=TEXT NAME='S2COL_city' VALUE="Busan" ><BR>
					</div>
					 <button id="btn" onclick="requestService(this)">Submit</button>
					 <button onClick="$('#request').html('');$('#response').html('')">Clear Result</button>
				</FORM>
			</LI>
			<P>
			<LI><B>Request:</B> <div id="request"></div></LI>
			<P>
			<LI><B>Response:</B> <div id="response"></div></LI>
			<P>
			<LI><B>SQL XML:</B> esConfig/sqlrepo/sample/mysql_insert1.xml<BR>
				<pre><div id="sql1"></div></pre>
			</LI>
			<LI><B>SQL XML:</B> esConfig/sqlrepo/sample/mysql_update1.xml<BR>
				<pre><div id="sql2"></div></pre>
			</LI>
		</UL>
		</div>
	</div>
</BODY>
</HTML>
